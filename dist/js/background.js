(()=>{"use strict";var e={7830:(e,s)=>{var r;Object.defineProperty(s,"__esModule",{value:!0}),s.GestureCommandTypes=void 0,(r=s.GestureCommandTypes||(s.GestureCommandTypes={}))[r.NewEmptyTab=0]="NewEmptyTab",r[r.CloseTab=1]="CloseTab",r[r.HistoryBack=2]="HistoryBack",r[r.HistoryForward=3]="HistoryForward",r[r.OpenLinkInBackground=4]="OpenLinkInBackground",r[r.UndoCloseTab=5]="UndoCloseTab"},210:(e,s)=>{var r;Object.defineProperty(s,"__esModule",{value:!0}),s.GestureTypes=void 0,(r=s.GestureTypes||(s.GestureTypes={}))[r.Up=0]="Up",r[r.Down=1]="Down",r[r.Left=2]="Left",r[r.Right=3]="Right"},9638:(e,s)=>{var r;Object.defineProperty(s,"__esModule",{value:!0}),s.MessageTypes=void 0,(r=s.MessageTypes||(s.MessageTypes={}))[r.Gesture=0]="Gesture",r[r.Url=1]="Url"}},s={};function r(t){var a=s[t];if(void 0!==a)return a.exports;var n=s[t]={exports:{}};return e[t](n,n.exports,r),n.exports}(()=>{const e=r(210),s=r(9638),t=r(7830);(new class{constructor(){this.enableUpOpenLink=!0,this.enableForceOverIFrame=!0,this.openLinkCount=0,chrome.storage.sync.get((e=>{console.log("[From Background]",e),this.enableUpOpenLink=e.UpOpenLink,this.enableForceOverIFrame=e.ForceOverIFrame})),chrome.tabs.onActivated.addListener((e=>{this.openLinkCount=0})),chrome.storage.onChanged.addListener(((e,s)=>{for(var r in e){var t=e[r];console.log('Storage key "%s" in namespace "%s" changed. Old value was "%s", new value is "%s".',r,s,t.oldValue,t.newValue),console.log("[From Background OnChange]",e.UpOpenLink),this.enableUpOpenLink=e.UpOpenLink.newValue}}))}run(){chrome.runtime.onMessage.addListener(((e,s,r)=>{let t=this.detectGestureCommand(e);this.exeGesture(t,e,s,r)}))}exeGesture(e,s,r,a){switch(e){case t.GestureCommandTypes.CloseTab:chrome.tabs.remove(r.tab.id);break;case t.GestureCommandTypes.HistoryBack:chrome.tabs.executeScript(null,{code:"window.history.back()"});break;case t.GestureCommandTypes.HistoryForward:chrome.tabs.executeScript(null,{code:"window.history.forward()"});break;case t.GestureCommandTypes.NewEmptyTab:chrome.tabs.create({url:"chrome://newtab"});break;case t.GestureCommandTypes.OpenLinkInBackground:chrome.tabs.query({active:!0},(e=>{chrome.tabs.create({url:s.url,active:!1,index:e[0].index+this.openLinkCount+++1})}));break;case t.GestureCommandTypes.UndoCloseTab:chrome.sessions.restore()}}detectGestureCommand(r){return this.arraysEqual(r.gestures,[e.GestureTypes.Down])?t.GestureCommandTypes.CloseTab:this.arraysEqual(r.gestures,[e.GestureTypes.Up])&&r.type==s.MessageTypes.Gesture?t.GestureCommandTypes.NewEmptyTab:this.arraysEqual(r.gestures,[e.GestureTypes.Up])&&r.type==s.MessageTypes.Url?this.enableUpOpenLink?t.GestureCommandTypes.OpenLinkInBackground:t.GestureCommandTypes.NewEmptyTab:this.arraysEqual(r.gestures,[e.GestureTypes.Left])?t.GestureCommandTypes.HistoryBack:this.arraysEqual(r.gestures,[e.GestureTypes.Right])?t.GestureCommandTypes.HistoryForward:this.arraysEqual(r.gestures,[e.GestureTypes.Up,e.GestureTypes.Down])?t.GestureCommandTypes.UndoCloseTab:void 0}arraysEqual(e,s){if(e===s)return!0;if(null==e||null==s)return!1;if(e.length!=s.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==s[r])return!1;return!0}}).run()})()})();