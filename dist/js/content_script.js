(()=>{"use strict";var e,t={5278:(e,t,r)=>{const o=r(1322);chrome.runtime.onMessage.addListener((function(e,t,r){e.color?(console.log("Receive color = "+e.color),document.body.style.backgroundColor=e.color,r("Change color to "+e.color)):r("Color message is none.")})),new o.CGMain},1322:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CGMain=void 0;const o=r(4143),s=r(3464),n=r(9638),i=r(210);t.CGMain=class{constructor(){this.inGesture=!1,this.gestures=[],this.forceOverIFrameState=!1,this.initIndicatorElement(),o.fromEvent(document,"contextmenu").subscribe((e=>{this.inGesture&&e.preventDefault(),this.inGesture=!1}));let e=o.fromEvent(document,"mousemove").pipe(s.tap((e=>{this.showIndicator(!0)})),s.takeUntil(o.fromEvent(document,"mouseup").pipe(s.tap((e=>{this.showIndicator(!1),this.anchorCoordinate=null,this.currentAnchorTarget?(console.log("is anchor",this.currentAnchorTarget),chrome.runtime.sendMessage({type:n.MessageTypes.Url,gestures:this.gestures,url:this.currentAnchorTarget.href})):chrome.runtime.sendMessage({type:n.MessageTypes.Gesture,gestures:this.gestures,url:null}),this.gestures=[]})))));o.fromEvent(document,"mousedown").pipe(s.tap((e=>{this.inGesture=!1})),s.filter((e=>this.isGestureButton(e))),s.tap((e=>{console.log("tapping mouse down is anchor"),this.currentAnchorTarget=this.lookupParentsForAnchor(e),console.log("[currentAnchorTarget]",this.currentAnchorTarget,chrome.tabs)})),s.switchMap((t=>e))).subscribe((e=>{let t=this.getCoordinate(e);if(this.anchorCoordinate||(this.anchorCoordinate=t),this.getDistance(this.anchorCoordinate,t)>10){this.inGesture=!0;let e=this.getVector(this.getDegrees(this.anchorCoordinate,t));null!=e&&((this.gestures.length>0&&this.gestures[this.gestures.length-1]!=e||0==this.gestures.length)&&this.gestures.push(e),this.printGestures(),this.anchorCoordinate=t)}})),this.setIFrameMouseEventBorderStyle(),this.initReadyIndicatorElement(),chrome.storage.sync.get("ForceOverIFrame",(e=>{console.log("this is what i get ForceOverIFrame",e.ForceOverIFrame),this.forceOverIFrameState=e.ForceOverIFrame})),chrome.storage.onChanged.addListener(((e,t)=>{var r;console.log(e),this.togglePointerEventNoneToIFrame(null===(r=null==e?void 0:e.ForceOverIFrame)||void 0===r?void 0:r.newValue)})),this.listenToMutationObserver()}togglePointerEventNoneToIFrame(e){e?document.querySelectorAll("iframe").forEach((e=>{e.classList.add("pointer-event-none")})):document.querySelectorAll("iframe").forEach((e=>{e.classList.remove("pointer-event-none")}))}listenToMutationObserver(){const e=document;new MutationObserver(((e,t)=>{var r;for(const t of e)"childList"===t.type&&(null===(r=t.addedNodes)||void 0===r||r.forEach((e=>{"IFRAME"==e.nodeName&&(console.log("iframe found added",e),this.togglePointerEventNoneToIFrame(this.forceOverIFrameState))})))})).observe(e,{childList:!0,subtree:!0})}lookupParentsForAnchor(e){console.log("this.currentAnchorTarget",e.target);let t=e.target;if(null!=t.href)return t;for(;t.parentElement;)if(t=t.parentElement,null!=t.href)return t;return null}getCoordinate(e){return{x:e.clientX,y:e.clientY}}getDistance(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}getDegrees(e,t){return 180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI}getVector(e){return e>-30&&e<30?(console.log("gesture","left"),i.GestureTypes.Left):e>60&&e<120?(console.log("gesture","up"),i.GestureTypes.Up):e>-120&&e<-60?(console.log("gesture","down"),i.GestureTypes.Down):e>150||e<-150?(console.log("gesture","right"),i.GestureTypes.Right):void console.log("undefined")}isGestureButton(e){return 2==e.button}getVectorText(){return this.gestures.map((e=>i.GestureTypes[e]))}addDot(e){let t=document.createElement("div");t.style.position="absolute",t.style.left=e.clientX+"px",t.style.top=e.clientY+"px",t.style.width="3px",t.style.height="3px",t.style.backgroundColor=0==e.button?"red":"green",document.body.appendChild(t)}initIndicatorElement(){this.indicatorElement=document.createElement("div"),this.indicatorElement.id="chrogestureid",this.indicatorElement.classList.add("chgs-indicator"),this.showIndicator(!1),document.body.appendChild(this.indicatorElement)}initReadyIndicatorElement(){let e=document.createElement("div");e.id="chrogestureready",e.classList.add("ready-indicator"),e.innerText="Gesture ready",e.style.visibility="hidden",document.body.appendChild(e)}showIndicator(e){this.indicatorElement.style.visibility=e?"initial":"hidden"}printGestures(){this.indicatorElement.innerText=this.gestures.map((e=>{switch(e){case i.GestureTypes.Up:return"ðŸ”¼";case i.GestureTypes.Down:return"ðŸ”½";case i.GestureTypes.Left:return"â—€";case i.GestureTypes.Right:return"â–¶"}})).join(" ")}setIFrameMouseEventBorderStyle(){}}},210:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.GestureTypes=void 0,(r=t.GestureTypes||(t.GestureTypes={}))[r.Up=0]="Up",r[r.Down=1]="Down",r[r.Left=2]="Left",r[r.Right=3]="Right"},9638:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.MessageTypes=void 0,(r=t.MessageTypes||(t.MessageTypes={}))[r.Gesture=0]="Gesture",r[r.Url=1]="Url"}},r={};function o(e){var s=r[e];if(void 0!==s)return s.exports;var n=r[e]={exports:{}};return t[e](n,n.exports,o),n.exports}o.m=t,e=[],o.O=(t,r,s,n)=>{if(!r){var i=1/0;for(c=0;c<e.length;c++){for(var[r,s,n]=e[c],a=!0,l=0;l<r.length;l++)(!1&n||i>=n)&&Object.keys(o.O).every((e=>o.O[e](r[l])))?r.splice(l--,1):(a=!1,n<i&&(i=n));a&&(e.splice(c--,1),t=s())}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[r,s,n]},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.j=828,(()=>{var e={828:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var s,n,[i,a,l]=r,c=0;for(s in a)o.o(a,s)&&(o.m[s]=a[s]);for(l&&l(o),t&&t(r);c<i.length;c++)n=i[c],o.o(e,n)&&e[n]&&e[n][0](),e[i[c]]=0;o.O()},r=self.webpackChunkchrome_extension_typescript_starter=self.webpackChunkchrome_extension_typescript_starter||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var s=o.O(void 0,[736],(()=>o(5278)));s=o.O(s)})();